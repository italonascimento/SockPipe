<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    Hello World

    <script>
      function createSocket() {
        const socket = new WebSocket('ws://localhost:8080', 'echo-protocol')
        socket.onopen = function(event) {
          socket.send(JSON.stringify({
            type: 'query',
            data: `{
              user(n: 0) {
                name
              }
            }`
          }))

          socket.send(JSON.stringify({
            type: 'subscribe',
            data: `{
              users {
                name,
                age
              }
            }`
          }))
        }

        socket.onmessage = function(e) {
          console.log(JSON.parse(e.data))
        }
      }

      window.addEventListener("load", createSocket, false)
    </script>
  </body>
</html>
